
## Map normalised (forced through the origin) pixel values to cone catch quanta
## Follows J Troscianko's imageJ tool box approach

## Illumination codes refer to photography then model illumination, repsectively

## Title refers to cone mapping model (see 'Cone_mapping_models' in 'Data' folder)

## Assumes input pixel values are in the range 0-100!

## Some models trained using 'expanded' spectra dataset (see https://doi.org/10.1111/2041-210X.14255)

# # ============================ #
# 
# ## Int2-Poly1 Models (micaToolbox default)
# ## Natural spectra (n = 3,139)
# 
# # Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Pavo_Average_VS_Pavo_Ideal_300-700.java
# 
# fun.camA.ideal.vs.int2poly1 <- function (vR, vG, vB, uR, uB) {
# 	
# 	uv <- (0.0019357112996143888 +(vR*4.884919949754315E-4)+(vG*-0.0017377401908979068)+(vB*0.005548577056924069)+(uB*0.004805590094073087)+(uR*6.405080192328964E-4)+(vR*vG*-3.9884561209997285E-6)+(vR*vB*-2.139156887112478E-6)+(vR*uB*1.599305082478802E-5)+(vR*uR*-2.479153055493032E-5)+(vG*vB*3.825308727914733E-6)+(vG*uB*-9.577066716947066E-5)+(vG*uR*1.148822781075186E-4)+(vB*uB*1.2816529952596544E-4)+(vB*uR*-1.3442102245953488E-4)+(uB*uR*4.649481308943092E-7));
# 	sw <- (-0.006958686384095355 +(vR*-9.534677582230848E-4)+(vG*0.002524086732511727)+(vB*0.009151431921746047)+(uB*-0.001547305541815493)+(uR*0.0012826030197915796)+(vR*vG*2.290534596924091E-6)+(vR*vB*2.2955090419893395E-6)+(vR*uB*7.892095231244523E-6)+(vR*uR*-2.0686742432174876E-5)+(vG*vB*-9.001923960745447E-7)+(vG*uB*1.3893243379047273E-4)+(vG*uR*-1.0814899394813461E-4)+(vB*uB*-1.9259763241346816E-4)+(vB*uR*1.7914684664079416E-4)+(uB*uR*-1.2990591491587613E-5));
# 	mw <- (0.004091729186930322 +(vR*-0.0015897326002876448)+(vG*0.016492735227638767)+(vB*-0.004917001824153917)+(uB*-2.1091535493722595E-4)+(uR*1.3430873851408984E-4)+(vR*vG*4.365613628092794E-6)+(vR*vB*-2.7148430332211336E-6)+(vR*uB*1.5263126186285812E-5)+(vR*uR*-1.6275160499927868E-5)+(vG*vB*-4.147018408759423E-6)+(vG*uB*-8.46151704045505E-5)+(vG*uR*8.078172730605965E-5)+(vB*uB*8.325010011241068E-5)+(vB*uR*-7.77923478583312E-5)+(uB*uR*2.5177700534988265E-6));
# 	lw <- (-0.009252332643176797 +(vR*0.008627425572004587)+(vG*0.0048955151133196866)+(vB*-0.0036862558464655984)+(uB*5.043021045724302E-4)+(uR*-3.7662887456272714E-4)+(vR*vG*-2.297437704910493E-5)+(vR*vB*1.5242842015043772E-5)+(vR*uB*4.61034001970433E-7)+(vR*uR*1.1379266971020932E-5)+(vG*vB*1.2418608198235019E-5)+(vG*uB*3.5092626299640854E-5)+(vG*uR*-6.13510449831419E-5)+(vB*uB*-3.5000726318959814E-5)+(vB*uR*4.298483551610137E-5)+(uB*uR*3.667044251554614E-6));
# 	dbl <- (-0.003466269931168425 +(vR*0.0015567713580986625)+(vG*0.010543320358004914)+(vB*-0.002180707387753615)+(uB*1.10308084353549E-4)+(uR*3.4863905580943344E-5)+(vR*vG*-4.2095881906796025E-6)+(vR*vB*2.451223961328974E-7)+(vR*uB*5.899213930292852E-6)+(vR*uR*-3.053105668336393E-6)+(vG*vB*4.963562692181445E-6)+(vG*uB*7.783844167277845E-6)+(vG*uR*-1.1055054093352661E-5)+(vB*uB*-1.6180708600601784E-5)+(vB*uR*1.4561352821415775E-5)+(uB*uR*7.68530658197583E-7));
# 	return(cbind(uv,sw,mw,lw,dbl))
#   
# }
# 
# # --------- #
# 
# # Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Pavo_Average_UV_Pavo_Ideal_300-700.java
# 
# fun.camA.ideal.uv.int2poly1 <- function (vR, vG, vB, uR, uB) {
# 	
# 	uv <- (-8.691613668778188E-4 +(vR*2.994473382550617E-4)+(vG*-4.671962090903499E-4)+(vB*8.681411362917704E-4)+(uB*-7.860416649358242E-4)+(uR*0.009905717437821883)+(vR*vG*-3.0713718820871904E-6)+(vR*vB*-4.177235437188628E-6)+(vR*uB*3.4179050435155055E-5)+(vR*uR*-5.183789152035835E-5)+(vG*vB*3.3685046502676016E-6)+(vG*uB*-8.708157846778359E-5)+(vG*uR*1.2255991216471345E-4)+(vB*uB*5.556326613627589E-5)+(vB*uR*-5.994148653365713E-5)+(uB*uR*-8.896957778756724E-6));
# 	sw <- (-0.0014062587531597052 +(vR*-1.324837683410104E-4)+(vG*-6.427752612614691E-4)+(vB*0.01085637589280295)+(uB*-2.1702404181727237E-4)+(uR*2.0351801899572418E-4)+(vR*vG*-3.495664340082414E-8)+(vR*vB*8.253706333592812E-7)+(vR*uB*-2.562285077350823E-6)+(vR*uR*-3.189273364633527E-7)+(vG*vB*3.576613350591918E-7)+(vG*uB*4.029313316920894E-5)+(vG*uR*-3.316843598611875E-5)+(vB*uB*-4.672027062123896E-5)+(vB*uR*4.360042241071987E-5)+(uB*uR*-2.965553031610012E-6));
# 	mw <- (0.004304998567677905 +(vR*-0.0016334970870416396)+(vG*0.016557499481761218)+(vB*-0.004945265129663611)+(uB*-1.8931631589390492E-4)+(uR*1.1086602822791478E-4)+(vR*vG*4.602670633168542E-6)+(vR*vB*-2.8596432350672133E-6)+(vR*uB*1.3725593444046049E-5)+(vR*uR*-1.4535200994177025E-5)+(vG*vB*-4.244756676224393E-6)+(vG*uB*-8.314587137455951E-5)+(vG*uR*7.885193213528025E-5)+(vB*uB*8.333693085102075E-5)+(vB*uR*-7.757225990689571E-5)+(uB*uR*2.5516852119262444E-6));
# 	lw <- (-0.009335807725859808 +(vR*0.008878592814658085)+(vG*0.004540872347304965)+(vB*-0.0035712211073726566)+(uB*4.4102674892950263E-4)+(uR*-3.1730363656827016E-4)+(vR*vG*-2.4154457766291984E-5)+(vR*vB*1.7405717116666413E-5)+(vR*uB*2.0213295544175892E-6)+(vR*uR*9.270820982373968E-6)+(vG*vB*1.1425180843688384E-5)+(vG*uB*3.350431345228463E-5)+(vG*uR*-5.8487072056074016E-5)+(vB*uB*-3.506791819473804E-5)+(vB*uR*4.23793083585427E-5)+(uB*uR*3.53505179841515E-6));
# 	dbl <- (-0.003466269931168425 +(vR*0.0015567713580986625)+(vG*0.010543320358004914)+(vB*-0.002180707387753615)+(uB*1.10308084353549E-4)+(uR*3.4863905580943344E-5)+(vR*vG*-4.2095881906796025E-6)+(vR*vB*2.451223961328974E-7)+(vR*uB*5.899213930292852E-6)+(vR*uR*-3.053105668336393E-6)+(vG*vB*4.963562692181445E-6)+(vG*uB*7.783844167277845E-6)+(vG*uR*-1.1055054093352661E-5)+(vB*uB*-1.6180708600601784E-5)+(vB*uR*1.4561352821415775E-5)+(uB*uR*7.68530658197583E-7));
# 	return(cbind(uv,sw,mw,lw,dbl))
#   
# }
# 
# # --------- #
# 
# # Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Human_Pavo_Ideal_400-700.java
# 
# fun.camA.ideal.human.int2poly1 <- function (vR, vG, vB) {
# 	
# 	lw <- (-0.003422746578167573 +(vR*0.0019632048864783366)+(vG*0.011278687618974147)+(vB*-0.0032183770305561367)+(vR*vG*-6.098010532938055E-6)+(vR*vB*3.6285296342385065E-6)+(vG*vB*2.714144247432087E-6));
# 	mw <- (-0.0018536981783689472 +(vR*-5.855976573310722E-4)+(vG*0.01274307029388839)+(vB*-0.0020289829759778757)+(vR*vG*8.085962604900846E-7)+(vR*vB*-4.6760735759025653E-7)+(vG*vB*-1.4421626372662235E-6));
# 	sw <- (0.005725034593166432 +(vR*3.4893057642905413E-4)+(vG*-0.00230052194386572)+(vB*0.011147368920713075)+(vR*vG*1.1397811790551205E-7)+(vR*vB*1.1752358745787396E-6)+(vG*vB*5.359253087413299E-6));
# 	return(cbind(sw,mw,lw))
#   
# }
# 
# # --------- #
# 
# # Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_CIE_XYZ_1931_Pavo_Ideal_400-700.java
# 
# fun.camA.ideal.ciexyz.int2poly1 <- function (vR, vG, vB) {
# 	
# 	X <- (-0.004028278523617956 +(vR*0.004600522949975679)+(vG*0.007036093477931121)+(vB*-0.0018136412339562456)+(vR*vG*-1.2955598844254393E-5)+(vR*vB*7.559157242413561E-6)+(vG*vB*7.785201091976883E-6));
# 	Y <- (-0.002670147338477955 +(vR*0.0010605820650180697)+(vG*0.01224213814968243)+(vB*-0.003244155721917042)+(vR*vG*-3.4122064539105085E-6)+(vR*vB*1.6011219880203397E-6)+(vG*vB*1.5405327825999776E-6));
# 	Z <- (0.002026342887983358 +(vR*1.2483083965914835E-4)+(vG*-0.0015327750983712954)+(vB*0.011099692096120252)+(vR*vG*-3.587153332491018E-7)+(vR*vB*9.982926738924932E-7)+(vG*vB*2.033639228057373E-6));
# 	return(cbind(X,Y,Z))
#   
# }
# 
# # --------- #
# 
# # Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Segments_Pavo_Ideal_300-700.java
# 
# fun.camA.ideal.segments.ubgr.int2poly1 <- function (vR, vG, vB, uR, uB) {
# 
# 	sU <- (-0.0032644934698730574 +(vR*4.505917720699837E-4)+(vG*-4.6754130480350283E-4)+(vB*8.865092207526148E-4)+(uB*-0.0042680206557984554)+(uR*0.013068122242816274)+(vR*vG*-4.051457648442438E-6)+(vR*vB*-1.1629003963336934E-5)+(vR*uB*7.180357858021319E-5)+(vR*uR*-1.0413832178469969E-4)+(vG*vB*7.525856697975913E-6)+(vG*uB*-1.3095094630487882E-4)+(vG*uR*1.953992225547051E-4)+(vB*uB*4.3356805633941384E-5)+(vB*uR*-6.44796602399285E-5)+(uB*uR*-2.9175010799215115E-6));
# 	sB <- (-2.1251226934453025E-4 +(vR*1.7462950700134123E-4)+(vG*-0.001459178075193849)+(vB*0.009827519063578455)+(uB*0.0025361762050395823)+(uR*-0.0011973059124036646)+(vR*vG*-2.073166684629276E-6)+(vR*vB*-8.975377064619649E-7)+(vR*uB*-1.1750638061403758E-7)+(vR*uR*-7.357155448627245E-6)+(vG*vB*3.5448953125168007E-6)+(vG*uB*3.892265591485949E-6)+(vG*uR*1.1787728329670328E-5)+(vB*uB*1.9383584000526825E-5)+(vB*uR*-2.504850804535014E-5)+(uB*uR*-2.0541330351096103E-6));
# 	sG <- (-0.0027162548427125694 +(vR*-7.643993644462883E-4)+(vG*0.014301486115169527)+(vB*-0.003410312458882387)+(uB*-3.414030475358216E-5)+(uR*9.428982165195432E-5)+(vR*vG*2.3864960887222474E-6)+(vR*vB*-7.219779763323281E-6)+(vR*uB*1.9594128867375063E-5)+(vR*uR*-2.1323920500320507E-5)+(vG*vB*4.2586257759278985E-6)+(vG*uB*-2.5923617569822997E-5)+(vG*uR*3.5286506616105E-5)+(vB*uB*5.159881082870575E-6)+(vB*uR*-1.573212418478911E-5)+(uB*uR*1.6469167658723505E-6));
# 	sR <- (0.007918762076997352 +(vR*0.012628134556222971)+(vG*-0.004487792842426448)+(vB*0.001984554480746035)+(uB*2.2276599239853806E-4)+(uR*-3.252851367793448E-4)+(vR*vG*5.809012595024948E-6)+(vR*vB*1.913306838009687E-6)+(vR*uB*-6.897380586298604E-6)+(vR*uR*3.369588319168531E-6)+(vG*vB*-1.0456205761089077E-5)+(vG*uB*-4.019759795236334E-6)+(vG*uR*1.754500788349038E-5)+(vB*uB*-9.799833826217827E-6)+(vB*uR*8.187186360609146E-6)+(uB*uR*-7.3408608332909355E-6));
# 	return(cbind(sU,sB,sG,sR))
# 
# }
# 
# # --------- #
# 
# # Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Segments_Pavo_Ideal_400-700.java
# 
# fun.camA.ideal.segments.bgr.int2poly1 <- function (vR, vG, vB, uR, uB) {
# 
# 	sB <- (0.008669176311210796 +(vR*2.2969395963947856E-4)+(vG*-0.002032766885464008)+(vB*0.010271149412792202)+(vR*vG*-2.8738003909025094E-7)+(vR*vB*6.482336687764317E-6)+(vG*vB*7.381407009603978E-6));
# 	sG <- (-0.002644196693640081 +(vR*-7.976156805952624E-4)+(vG*0.014387136054212974)+(vB*-0.003443764299674575)+(vR*vG*2.8312758412093648E-6)+(vR*vB*-5.004718337859043E-6)+(vG*vB*8.449271873605491E-7));
# 	sR <- (0.00839795860351248 +(vR*0.01254017668239761)+(vG*-0.004424937031099573)+(vB*0.0019136254246779941)+(vR*vG*8.87868507633201E-6)+(vR*vB*-5.545004454946626E-7)+(vG*vB*-9.79548340623622E-6));
# 	return(cbind(sB,sG,sR))
# 
# }
# 
# # ============================ #

## Int2-Poly1 Models (micaToolbox default)
## Expanded natural spectra (n = 15,695)

# Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Pavo_Average_VS_Pavo_Ideal_300-700-expanded.java

fun.camA.ideal.vs.int2poly1.expanded <- function (vR, vG, vB, uR, uB) {
	
	uv <- (3.4883895795656184E-5 +(vR*5.247114073394826E-4)+(vG*-0.0017062893289955545)+(vB*0.0055290533162272865)+(uB*0.005280689453309477)+(uR*2.449486176865037E-4)+(vR*vG*-4.805162698902656E-6)+(vR*vB*-7.346581096132137E-7)+(vR*uB*5.4685597603305395E-6)+(vR*uR*-1.6899964768504037E-5)+(vG*vB*2.970909813870941E-6)+(vG*uB*-8.844041673816434E-5)+(vG*uR*1.1087376183966326E-4)+(vB*uB*1.2179594805010249E-4)+(vB*uR*-1.294345915362802E-4)+(uB*uR*1.5443318879465903E-7));
	sw <- (-1.6313684263608022E-4 +(vR*-0.0011280885798598702)+(vG*0.0023564145197768937)+(vB*0.009301400763861089)+(uB*-0.002606759186574662)+(uR*0.002138923153736545)+(vR*vG*7.327011784336639E-6)+(vR*vB*-3.210568885099802E-6)+(vR*uB*3.273256021799125E-5)+(vR*uR*-3.847125739996253E-5)+(vG*vB*8.235263625350531E-7)+(vG*uB*1.2511737700223588E-4)+(vG*uR*-1.0235124142555173E-4)+(vB*uB*-1.8231644736008005E-4)+(vB*uR*1.7077866480722512E-4)+(uB*uR*-1.1426095797521005E-5));
	mw <- (1.1622684395747832E-4 +(vR*-0.0014830715772230394)+(vG*0.016665302559480198)+(vB*-0.0050770557828371775)+(uB*3.832205721677549E-4)+(uR*-3.873681385774573E-4)+(vR*vG*-3.9918347272721854E-8)+(vR*vB*1.9132369381283684E-6)+(vR*uB*-1.731506389634741E-7)+(vR*uR*-3.5969752127480515E-6)+(vG*vB*-5.213379330693412E-6)+(vG*uB*-7.817189061945866E-5)+(vG*uR*7.723291407228909E-5)+(vB*uB*8.086018065015871E-5)+(vB*uR*-7.525766999220726E-5)+(uB*uR*1.3661068118317366E-6));
	lw <- (-3.1914333011126995E-4 +(vR*0.00838714565175928)+(vG*0.004308341593308493)+(vB*-0.0031613823771065226)+(uB*-4.663718941660177E-4)+(uR*5.114585359174181E-4)+(vR*vG*-9.485647896760223E-6)+(vR*vB*1.5475142434170726E-6)+(vR*uB*3.1439108740390426E-5)+(vR*uR*-1.6242705907766795E-5)+(vG*vB*1.5171336112402456E-5)+(vG*uB*2.7107207618317707E-5)+(vG*uR*-5.502097377361828E-5)+(vB*uB*-4.0139467384672716E-5)+(vB*uR*4.345680441377153E-5)+(uB*uR*7.3769990668354714E-6));
	dbl <- (-1.0544979721066653E-4 +(vR*0.0014709063997941974)+(vG*0.010378782427678692)+(vB*-0.0020526053269969012)+(uB*-2.6958873663153905E-4)+(uR*3.7353984492219025E-4)+(vR*vG*-2.980840024845194E-7)+(vR*vB*-3.419399239171408E-6)+(vR*uB*1.6427954610944008E-5)+(vR*uR*-1.1974755559207828E-5)+(vG*vB*5.8077800980947696E-6)+(vG*uB*3.627998939567357E-6)+(vG*uR*-8.536616709636622E-6)+(vB*uB*-1.5150428165844035E-5)+(vB*uR*1.2798214483425781E-5)+(uB*uR*1.9061233794070093E-6));
	return(cbind(uv,sw,mw,lw,dbl))
  
}

# --------- #

# Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Pavo_Average_UV_Pavo_Ideal_300-700-expanded.java

fun.camA.ideal.uv.int2poly1.expanded <- function (vR, vG, vB, uR, uB) {
	
	uv <- (-1.0072645856543222E-4 +(vR*2.656681655868963E-4)+(vG*-5.068912001434062E-4)+(vB*8.807031837400417E-4)+(uB*-8.51767628459907E-4)+(uR*0.010001038089545292)+(vR*vG*-1.7442166408753685E-6)+(vR*vB*-4.072619129161714E-6)+(vR*uB*3.5552224437902936E-5)+(vR*uR*-5.4142649401885054E-5)+(vG*vB*2.7000549174292213E-6)+(vG*uB*-8.844846862608557E-5)+(vG*uR*1.2402794993867318E-4)+(vB*uB*5.712851064047926E-5)+(vB*uR*-6.157175168330311E-5)+(uB*uR*-8.51608159488413E-6));
	sw <- (-3.229029565299134E-5 +(vR*-1.7026643205230075E-4)+(vG*-6.807783829936864E-4)+(vB*0.0108993521112189)+(uB*-4.5212882213361216E-4)+(uR*3.9755680570539853E-4)+(vR*vG*1.132946264533436E-6)+(vR*vB*-5.609632726275387E-7)+(vR*uB*3.1010255525254463E-6)+(vR*uR*-4.513028334272119E-6)+(vG*vB*7.230150619585592E-7)+(vG*uB*3.753211813835518E-5)+(vG*uR*-3.200234702080414E-5)+(vB*uB*-4.5045649541170734E-5)+(vB*uR*4.229031861293349E-5)+(uB*uR*-2.6632371305764216E-6));
	mw <- (1.229975364943929E-4 +(vR*-0.0015216879782443656)+(vG*0.016739432462496474)+(vB*-0.00511190123344914)+(uB*4.236292426241492E-4)+(uR*-4.2627071710053485E-4)+(vR*vG*-2.5821513349848594E-8)+(vR*vB*1.9647622682695667E-6)+(vR*uB*-2.240636669502069E-6)+(vR*uR*-1.4422910213585519E-6)+(vG*vB*-5.359352040828575E-6)+(vG*uB*-7.647244014122641E-5)+(vG*uR*7.518474561971779E-5)+(vB*uB*8.085726066051999E-5)+(vB*uR*-7.489876104635781E-5)+(uB*uR*1.3240918187677544E-6));
	lw <- (-3.2674106020576883E-4 +(vR*0.0086361781366186)+(vG*0.003940421038090461)+(vB*-0.0030333184099389106)+(uB*-5.279319408751551E-4)+(uR*5.668779542889099E-4)+(vR*vG*-1.0396031692336333E-5)+(vR*vB*3.408196259708747E-6)+(vR*uB*3.325090506155861E-5)+(vR*uR*-1.8568872302079177E-5)+(vG*vB*1.4233420422229957E-5)+(vG*uB*2.5609228198758987E-5)+(vG*uR*-5.2131306767304E-5)+(vB*uB*-4.057759093927875E-5)+(vB*uR*4.2991263255130344E-5)+(uB*uR*7.3468699809824446E-6));
	dbl <- (-1.0544979721066653E-4 +(vR*0.0014709063997941974)+(vG*0.010378782427678692)+(vB*-0.0020526053269969012)+(uB*-2.6958873663153905E-4)+(uR*3.7353984492219025E-4)+(vR*vG*-2.980840024845194E-7)+(vR*vB*-3.419399239171408E-6)+(vR*uB*1.6427954610944008E-5)+(vR*uR*-1.1974755559207828E-5)+(vG*vB*5.8077800980947696E-6)+(vG*uB*3.627998939567357E-6)+(vG*uR*-8.536616709636622E-6)+(vB*uB*-1.5150428165844035E-5)+(vB*uR*1.2798214483425781E-5)+(uB*uR*1.9061233794070093E-6));
	return(cbind(uv,sw,mw,lw,dbl))
  
}

# --------- #

# Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Human_Pavo_Ideal_400-700-expanded.java

fun.camA.ideal.human.int2poly1.expanded <- function (vR, vG, vB) {
	
	lw <- (-1.3810303313076163E-4 +(vR*0.0018766708506130223)+(vG*0.011133982165506892)+(vB*-0.0031409145919393676)+(vR*vG*-2.636490705310806E-6)+(vR*vB*1.8781914384317278E-6)+(vG*vB*2.369242304686164E-6));
	mw <- (-6.446685545697272E-5 +(vR*-6.220256131688168E-4)+(vG*0.012693101005773583)+(vB*-0.0020388441615948093)+(vR*vG*1.8408557818679231E-6)+(vR*vB*-4.2274924272083954E-7)+(vG*vB*-1.5960178998845583E-6));
	sw <- (3.125739860433223E-4 +(vR*4.5506800350470004E-4)+(vG*-0.0021128598989616004)+(vB*0.011183985721549189)+(vR*vG*-3.566306591526968E-6)+(vR*vB*8.362977258295697E-7)+(vG*vB*6.0892707510163585E-6));
	return(cbind(sw,mw,lw))
  
}

# --------- #

# Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_CIE_XYZ_1931_Pavo_Ideal_400-700-expanded.java

fun.camA.ideal.ciexyz.int2poly1.expanded <- function (vR, vG, vB) {
	
	X <- (-1.6852722493360751E-4 +(vR*0.004482620394181034)+(vG*0.006827392852876124)+(vB*-0.0016461234101870707)+(vR*vG*-7.68991100669847E-6)+(vR*vB*4.033490221417501E-6)+(vG*vB*7.34638874312335E-6));
	Y <- (-1.0791273398855007E-4 +(vR*9.963296881102051E-4)+(vG*0.012138548588897964)+(vB*-0.0032012933416830534)+(vR*vG*-9.817641066771572E-7)+(vR*vB*5.815285505576248E-7)+(vG*vB*1.2656423527074655E-6));
	Z <- (1.1631895079713279E-4 +(vR*1.6097462878473596E-4)+(vG*-0.0014685038573735239)+(vB*0.011119661319085167)+(vR*vG*-1.581692776789707E-6)+(vR*vB*7.344352854500916E-7)+(vG*vB*2.309467287440229E-6));
	return(cbind(X,Y,Z))
  
}

# --------- #

# Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Segments_Pavo_Ideal_300-700-expanded.java

fun.camA.ideal.segments.ubgr.int2poly1.expanded <- function (vR, vG, vB, uR, uB) {

	sU <- (-2.92230906225293E-4 +(vR*3.543997053171534E-4)+(vG*-5.770350101628715E-4)+(vB*8.875134462718899E-4)+(uB*-0.0046072035788181104)+(uR*0.013430282348904624)+(vR*vG*-6.441737771822209E-7)+(vR*vB*-1.1254474432435423E-5)+(vR*uB*7.839281599098881E-5)+(vR*uR*-1.1159511527612977E-4)+(vG*vB*6.2742752207430754E-6)+(vG*uB*-1.380604428594622E-4)+(vG*uR*2.0070649803878763E-4)+(vB*uB*5.2154263467490164E-5)+(vB*uR*-7.288440765047607E-5)+(uB*uR*-1.4381402360885671E-6));
	sB <- (1.279861985470836E-6 +(vR*1.5709932666280933E-4)+(vG*-0.001478425668747253)+(vB*0.009870897991528559)+(uB*0.0025798650728186177)+(uR*-0.0012359458191094823)+(vR*vG*-1.34025954518738E-6)+(vR*vB*-1.7359305147298882E-6)+(vR*uB*-4.555091794248633E-7)+(vR*uR*-7.00212436841111E-6)+(vG*vB*3.4630891636883393E-6)+(vG*uB*5.976091817096546E-6)+(vG*uR*1.0117333684195246E-5)+(vB*uB*1.639286881344021E-5)+(vB*uR*-2.253544069728325E-5)+(uB*uR*-1.9986728049538307E-6));
	sG <- (-6.800889874574049E-5 +(vR*-8.25060107496194E-4)+(vG*0.014248395265787937)+(vB*-0.0034110684607201462)+(uB*-3.03619387412608E-4)+(uR*3.1503781058439225E-4)+(vR*vG*3.860414990991865E-6)+(vR*vB*-7.894365416096907E-6)+(vR*uB*2.5178835370095274E-5)+(vR*uR*-2.5179192888419122E-5)+(vG*vB*4.622076271270825E-6)+(vG*uB*-3.0402880457623714E-5)+(vG*uR*3.71555562793751E-5)+(vB*uB*1.0063275272183586E-5)+(vB*uR*-1.9996712865191085E-5)+(uB*uR*2.3020516958345144E-6));
	sR <- (1.7387688720058633E-4 +(vR*0.012822104095060348)+(vG*-0.004112537970589985)+(vB*0.0016944218733824829)+(uB*9.970222563559644E-4)+(uR*-0.0010387401119784292)+(vR*vG*-2.9566010754185808E-6)+(vR*vB*1.024076853026047E-5)+(vR*uB*-2.9012876871102712E-5)+(vR*uR*2.2604240309623755E-5)+(vG*vB*-1.247026497577941E-5)+(vG*uB*2.908296706986456E-6)+(vG*uR*1.3416460174877072E-5)+(vB*uB*-9.044961639659067E-6)+(vB*uR*9.29230664716199E-6)+(uB*uR*-9.595206045990339E-6));
	return(cbind(sU,sB,sG,sR))

}

# --------- #

# Camera_setup_A_green_blue_sensitivity_norm_Broncolor_flash_A_dome_boxcar_0_IMAT_to_Segments_Pavo_Ideal_400-700-expanded.java

fun.camA.ideal.segments.bgr.int2poly1.expanded <- function (vR, vG, vB, uR, uB) {

	sB <- (5.779265531487731E-4 +(vR*3.81183282608865E-4)+(vG*-0.0017408153722624428)+(vB*0.010365521501647993)+(vR*vG*-5.78089554289782E-6)+(vR*vB*5.088958976574229E-6)+(vG*vB*8.786017684342353E-6));
	sG <- (-8.538861906935364E-5 +(vR*-8.507106955878824E-4)+(vG*0.014332226517344235)+(vB*-0.003472234857252222)+(vR*vG*4.021856166680102E-6)+(vR*vB*-4.610292604059797E-6)+(vG*vB*5.6798494854054E-7));
	sR <- (2.7930904962960445E-4 +(vR*0.012750418834585423)+(vG*-0.0041251950743857084)+(vB*0.0017748583692532296)+(vR*vG*1.5189639147846565E-6)+(vR*vB*2.7033313472226324E-6)+(vG*vB*-8.975796626520527E-6));
	return(cbind(sB,sG,sR))

}

# ============================ #

